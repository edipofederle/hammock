#!/usr/bin/env ruby

lib = File.expand_path("../../lib", __FILE__)
$:.unshift(lib) unless $:.include?(lib)

require 'hammock'
require 'hammock/rt'
require 'readline'
require 'stringio'

Hammock::RT.bootstrap!

reader = Hammock::Reader.new

while line = Readline.readline('> ', true)
  begin
    line = StringIO.new(line)
    p Hammock::RT.compile_and_eval(reader.read(line))
  rescue Exception => ex
    puts "ERROR: #{ex}"
    puts ex.backtrace
  end
end

